"use strict";(self.webpackChunknodejs_mobile_docs=self.webpackChunknodejs_mobile_docs||[]).push([[334],{3905:(e,t,o)=>{o.d(t,{Zo:()=>l,kt:()=>h});var n=o(7294);function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function s(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function r(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?s(Object(o),!0).forEach((function(t){i(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):s(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function a(e,t){if(null==e)return{};var o,n,i=function(e,t){if(null==e)return{};var o,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)o=s[n],t.indexOf(o)>=0||(i[o]=e[o]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)o=s[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var d=n.createContext({}),p=function(e){var t=n.useContext(d),o=t;return e&&(o="function"==typeof e?e(t):r(r({},t),e)),o},l=function(e){var t=p(e.components);return n.createElement(d.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var o=e.components,i=e.mdxType,s=e.originalType,d=e.parentName,l=a(e,["components","mdxType","originalType","parentName"]),c=p(o),m=i,h=c["".concat(d,".").concat(m)]||c[m]||u[m]||s;return o?n.createElement(h,r(r({ref:t},l),{},{components:o})):n.createElement(h,r({ref:t},l))}));function h(e,t){var o=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var s=o.length,r=new Array(s);r[0]=m;var a={};for(var d in t)hasOwnProperty.call(t,d)&&(a[d]=t[d]);a.originalType=e,a[c]="string"==typeof e?e:i,r[1]=a;for(var p=2;p<s;p++)r[p]=o[p];return n.createElement.apply(null,r)}return n.createElement.apply(null,o)}m.displayName="MDXCreateElement"},6427:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>p});var n=o(7462),i=(o(7294),o(3905));const s={sidebar_position:1,title:"Node.js APIs differences"},r=void 0,a={unversionedId:"api/differences",id:"api/differences",title:"Node.js APIs differences",description:"We support the majority of Node.js upstream APIs, see the official docs.",source:"@site/docs/api/differences.md",sourceDirName:"api",slug:"/api/differences",permalink:"/docs/api/differences",draft:!1,editUrl:"https://github.com/nodejs-mobile/nodejs-mobile.github.io/tree/main/docs/api/differences.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Node.js APIs differences"},sidebar:"api",next:{title:"React Native bridge",permalink:"/docs/api/react-native-bridge"}},d={},p=[{value:"Child processes",id:"child-processes",level:3},{value:"Console",id:"console",level:3},{value:"Debugger",id:"debugger",level:3},{value:"File system module",id:"file-system-module",level:3},{value:"<code>fs.link()</code>, <code>fs.linkSync()</code>",id:"fslink-fslinksync",level:4},{value:"Internationalization module",id:"internationalization-module",level:3},{value:"Operation system module",id:"operation-system-module",level:3},{value:"<code>os.cpus()</code>",id:"oscpus",level:4},{value:"<code>os.homedir()</code>",id:"oshomedir",level:4},{value:"<code>os.platform()</code>",id:"osplatform",level:4},{value:"<code>os.tmpdir()</code>",id:"ostmpdir",level:4},{value:"Process",id:"process",level:3},{value:"<code>process.cwd()</code>",id:"processcwd",level:4},{value:"<code>process.exit()</code>",id:"processexit",level:4},{value:"<code>process.getegid()</code>, <code>process.geteuid()</code>, <code>process.getgid()</code>, <code>process.getgroups()</code>, <code>process.getuid()</code>, <code>process.setegid()</code>, <code>process.seteuid()</code>, <code>process.setgid()</code>, <code>process.setgroups()</code>, <code>process.setuid()</code>",id:"processgetegid-processgeteuid-processgetgid-processgetgroups-processgetuid-processsetegid-processseteuid-processsetgid-processsetgroups-processsetuid",level:4},{value:"<code>process.stderr</code>, <code>process.stdout</code>",id:"processstderr-processstdout",level:4},{value:"<code>process.stdin</code>",id:"processstdin",level:4},{value:"<code>process.platform</code>",id:"processplatform",level:4},{value:"<code>process.versions</code>",id:"processversions",level:4},{value:"RegExp Unicode Property Names",id:"regexp-unicode-property-names",level:3},{value:"WebAssembly",id:"webassembly",level:3}],l={toc:p},c="wrapper";function u(e){let{components:t,...o}=e;return(0,i.kt)(c,(0,n.Z)({},l,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"We support the majority of Node.js upstream APIs, see ",(0,i.kt)("a",{parentName:"p",href:"https://nodejs.org/dist/v18.17.1/docs/api/"},"the official docs"),"."),(0,i.kt)("p",null,"However, some Node.js APIs were designed with the purpose of running on a server/desktop environment, and on mobile they might not work as intended or are not supported at all."),(0,i.kt)("p",null,"This page contains a collection of differences for these APIs when running on a mobile environment or a description of the quirks in their behavior. Please ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/nodejs-mobile/nodejs-mobile/issues/new/choose"},"file an issue in the core library repo")," for APIs that you find missing from the list."),(0,i.kt)("h3",{id:"child-processes"},"Child processes"),(0,i.kt)("admonition",{type:"danger"},(0,i.kt)("p",{parentName:"admonition"},"Unsupported")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"child_process")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"cluster")," modules are not available. nodejs-mobile runs in a mobile application process, which is expected to be a single process in the mobile operating systems, so forking the nodejs-mobile process results in errors for most cases. iOS doesn't give permissions to spawn new processes in most cases, as well. These modules are not supported in nodejs-mobile for the reasons presented."),(0,i.kt)("h3",{id:"console"},"Console"),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Supported, with minor differences")),(0,i.kt)("p",null,"The global ",(0,i.kt)("inlineCode",{parentName:"p"},"console")," instance is typically configured to write to ",(0,i.kt)("inlineCode",{parentName:"p"},"process.stdout")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"process.stderr"),". On Android, the ",(0,i.kt)("inlineCode",{parentName:"p"},"process.stderr")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"process.stdout")," streams output is sent to ",(0,i.kt)("inlineCode",{parentName:"p"},"/dev/null"),", but it can be redirected to the application ",(0,i.kt)("strong",{parentName:"p"},"logcat"),". The redirection is done automatically in the ",(0,i.kt)("inlineCode",{parentName:"p"},"nodejs-mobile-cordova")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"nodejs-mobile-react-native")," plugins. Instructions on how to achieve this in Android applications running the native nodejs-mobile library can be found in the Android ",(0,i.kt)("a",{parentName:"p",href:"../guide/guide-android/redirect-to-logcat"},"Redirect Output Streams to logcat")," guide."),(0,i.kt)("h3",{id:"debugger"},"Debugger"),(0,i.kt)("admonition",{type:"danger"},(0,i.kt)("p",{parentName:"admonition"},"Unsupported")),(0,i.kt)("p",null,"The V8 inspector is not available on current nodejs-mobile builds, due to a dependency on the ",(0,i.kt)("inlineCode",{parentName:"p"},"intl")," module. This means you cannot use (Chrome) DevTools to debug your nodejs-mobile app."),(0,i.kt)("h3",{id:"file-system-module"},"File system module"),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Supported, with significant differences")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"fs")," module provides wrappers around standard POSIX functions, but these might not be available on the mobile OSes, file systems or work differently in a mobile application process context."),(0,i.kt)("p",null,"Functions that can take relative paths apply that relative path to the current working directory where the node process was started in server/desktop environments. On mobile environments, nodejs-mobile is started in the context of an application, for which the current working environment is the root of the filesystem on iOS and Android. This can lead to unexpected behavior for code that assumes the current working directory is set to the directory of the starting Node.js script (which also might not be true in a server/desktop environment)."),(0,i.kt)("h4",{id:"fslink-fslinksync"},(0,i.kt)("inlineCode",{parentName:"h4"},"fs.link()"),", ",(0,i.kt)("inlineCode",{parentName:"h4"},"fs.linkSync()")),(0,i.kt)("p",null,"Android does not support these functions because it does not support hard links."),(0,i.kt)("h3",{id:"internationalization-module"},"Internationalization module"),(0,i.kt)("admonition",{type:"danger"},(0,i.kt)("p",{parentName:"admonition"},"Unsupported")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"intl")," (internationalization) module is not available on current nodejs-mobile builds."),(0,i.kt)("h3",{id:"operation-system-module"},"Operation system module"),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Supported, with significant differences")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"os")," module provides operating system-related utility methods. Some of these methods are not fully supported on mobile operating systems or behave differently in the context of an application process."),(0,i.kt)("h4",{id:"oscpus"},(0,i.kt)("inlineCode",{parentName:"h4"},"os.cpus()")),(0,i.kt)("p",null,"On iOS, CPU speed values are always 0, due to lack of permissions to read these values."),(0,i.kt)("p",null,"On Android, returns undefined since Android 8.0, due to lack of permissions to read these values. On earlier Android versions the CPU values can be inconsistent, since some devices can turn CPU cores on and off as an energy saving strategy. Properties can be returned as zero for cores that have been turned off while getting them."),(0,i.kt)("h4",{id:"oshomedir"},(0,i.kt)("inlineCode",{parentName:"h4"},"os.homedir()")),(0,i.kt)("p",null,"On Android and iOS there isn't the concept of a user home directory. Android sets this value to ",(0,i.kt)("inlineCode",{parentName:"p"},"/data")," and iOS sets it to root of the Application's sandboxed path."),(0,i.kt)("h4",{id:"osplatform"},(0,i.kt)("inlineCode",{parentName:"h4"},"os.platform()")),(0,i.kt)("p",null,"Returns the strings ",(0,i.kt)("inlineCode",{parentName:"p"},"'android'")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"'ios'")," in nodejs-mobile, depending on the platform."),(0,i.kt)("h4",{id:"ostmpdir"},(0,i.kt)("inlineCode",{parentName:"h4"},"os.tmpdir()")),(0,i.kt)("p",null,"On iOS, returns the application's sandboxed temporary directory, equivalent to getting the ",(0,i.kt)("inlineCode",{parentName:"p"},"NSTemporaryDirectory")," value, since iOS sets the ",(0,i.kt)("inlineCode",{parentName:"p"},"TMPDIR")," environment variable for the application to that value."),(0,i.kt)("p",null,"The Android OS is an outlier in the sense that it doesn't have the concept of a temporary directory. In the nodejs-mobile-cordova and nodejs-mobile-react-native plugins, the nodejs-mobile runtime returns the application context's ",(0,i.kt)("inlineCode",{parentName:"p"},"CacheDir")," value, which should have a similar behavior to a temporary directory for most situations (on Android, the files in the cache are kept until the system needs space, so it increases the disk foothold of the Application unless the developer deletes them manually)."),(0,i.kt)("h3",{id:"process"},"Process"),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Supported, with significant differences")),(0,i.kt)("p",null,"The global ",(0,i.kt)("inlineCode",{parentName:"p"},"process")," object provides information about the current process where Node.js is running on, which is the application process for nodejs-mobile."),(0,i.kt)("h4",{id:"processcwd"},(0,i.kt)("inlineCode",{parentName:"h4"},"process.cwd()")),(0,i.kt)("p",null,"The current working directory of the process is the same as the current working directory for the mobile application, which is the root of the operating system on Android and iOS applications, i.e. ",(0,i.kt)("inlineCode",{parentName:"p"},"/"),"."),(0,i.kt)("h4",{id:"processexit"},(0,i.kt)("inlineCode",{parentName:"h4"},"process.exit()")),(0,i.kt)("p",null,"In nodejs-mobile, the process is the application, so running ",(0,i.kt)("inlineCode",{parentName:"p"},"process.exit()")," terminates the application. This is not allowed in the Apple App Store guidelines for iOS."),(0,i.kt)("h4",{id:"processgetegid-processgeteuid-processgetgid-processgetgroups-processgetuid-processsetegid-processseteuid-processsetgid-processsetgroups-processsetuid"},(0,i.kt)("inlineCode",{parentName:"h4"},"process.getegid()"),", ",(0,i.kt)("inlineCode",{parentName:"h4"},"process.geteuid()"),", ",(0,i.kt)("inlineCode",{parentName:"h4"},"process.getgid()"),", ",(0,i.kt)("inlineCode",{parentName:"h4"},"process.getgroups()"),", ",(0,i.kt)("inlineCode",{parentName:"h4"},"process.getuid()"),", ",(0,i.kt)("inlineCode",{parentName:"h4"},"process.setegid()"),", ",(0,i.kt)("inlineCode",{parentName:"h4"},"process.seteuid()"),", ",(0,i.kt)("inlineCode",{parentName:"h4"},"process.setgid()"),", ",(0,i.kt)("inlineCode",{parentName:"h4"},"process.setgroups()"),", ",(0,i.kt)("inlineCode",{parentName:"h4"},"process.setuid()")),(0,i.kt)("p",null,"These functions are only available on POSIX platforms, so they are unavailable on Android."),(0,i.kt)("h4",{id:"processstderr-processstdout"},(0,i.kt)("inlineCode",{parentName:"h4"},"process.stderr"),", ",(0,i.kt)("inlineCode",{parentName:"h4"},"process.stdout")),(0,i.kt)("p",null,"Read above in the ",(0,i.kt)("a",{parentName:"p",href:"#console"},"Console")," section."),(0,i.kt)("h4",{id:"processstdin"},(0,i.kt)("inlineCode",{parentName:"h4"},"process.stdin")),(0,i.kt)("p",null,"nodejs-mobile is running in the context of a mobile application, so you can expect ",(0,i.kt)("inlineCode",{parentName:"p"},"process.stdin")," to be ",(0,i.kt)("strong",{parentName:"p"},"unavailable")," unless there is some native code added to pipe to it."),(0,i.kt)("h4",{id:"processplatform"},(0,i.kt)("inlineCode",{parentName:"h4"},"process.platform")),(0,i.kt)("p",null,"Like ",(0,i.kt)("inlineCode",{parentName:"p"},"os.platform()"),", this is the string ",(0,i.kt)("inlineCode",{parentName:"p"},"'android'")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"'ios'"),", depending on the platform."),(0,i.kt)("h4",{id:"processversions"},(0,i.kt)("inlineCode",{parentName:"h4"},"process.versions")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"process.versions")," object is supported, but also includes the ",(0,i.kt)("inlineCode",{parentName:"p"},"'mobile'")," key, containing the version for the nodejs-mobile core library."),(0,i.kt)("h3",{id:"regexp-unicode-property-names"},"RegExp Unicode Property Names"),(0,i.kt)("admonition",{type:"danger"},(0,i.kt)("p",{parentName:"admonition"},"Unsupported")),(0,i.kt)("p",null,"Nodejs-mobile is compiled with no internationalization which means that Unicode Property Names are not supported, examples:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"\\p{Letter}")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"\\p{L}")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"\\p{ID_Start}")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"\\p{ID_Continue}"))),(0,i.kt)("p",null,"As an alternative, you can unwrap the characters belonging to property names, like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const regenerate = require('regenerate');\nconst codePoints = require('@unicode/unicode-13.0.0/Binary_Property/ID_Start/code-points.js');\n\nconst set = regenerate(codePoints);\nconsole.log(new RegExp(`[$_${set.toString()}]`));\n")),(0,i.kt)("p",null,"Or do such as a dedicated package, like ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/staltz/unicode-word-regex"},"unicode-word-regex")," does."),(0,i.kt)("h3",{id:"webassembly"},"WebAssembly"),(0,i.kt)("admonition",{type:"danger"},(0,i.kt)("p",{parentName:"admonition"},"Unsupported")),(0,i.kt)("p",null,"On iOS, WASM is unsupported because it requires Just-in-time (JIT) interpretation, which is forbidden by Apple's App Store guidelines."),(0,i.kt)("p",null,"On Android, WASM ",(0,i.kt)("em",{parentName:"p"},"may")," work."))}u.isMDXComponent=!0}}]);